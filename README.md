# Парсер лизинга 0% для электроники в Эстонии

Автоматический парсер, который проверяет сайты продажи электроники в Эстонии (rde.ee, klick.ee, arvutitark.ee) на наличие возможности лизинга с 0% процентов. Парсер работает 2 раза в сутки и отображает результаты на веб-странице.

## Возможности

- ✅ Автоматический парсинг трех сайтов: rde.ee, klick.ee, arvutitark.ee
- ✅ Поиск товаров с лизингом 0%
- ✅ Расписание: проверка 2 раза в сутки (09:00 и 21:00)
- ✅ Веб-интерфейс для просмотра результатов
- ✅ База данных для хранения найденных товаров
- ✅ API для получения данных
- ✅ Ручной запуск парсинга через веб-интерфейс

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Запуск

Запустите главный файл:
```bash
python main.py
```

Приложение будет доступно по адресу: http://localhost:5000

## Структура проекта

- `parser.py` - Основной модуль парсинга для всех трех сайтов
- `database.py` - Работа с базой данных SQLite
- `app.py` - Flask веб-приложение
- `scheduler.py` - Планировщик задач (2 раза в сутки)
- `main.py` - Главный файл для запуска всего приложения
- `templates/index.html` - HTML шаблон веб-страницы
- `requirements.txt` - Зависимости проекта

## Использование

1. Запустите приложение командой `python main.py`
2. Откройте браузер и перейдите на http://localhost:5000
3. Парсер автоматически запустится при старте и затем будет работать по расписанию
4. Для ручного обновления нажмите кнопку "Обновить данные" на веб-странице

## API Endpoints

- `GET /` - Главная страница с результатами
- `GET /api/products` - Получить все товары (JSON)
- `GET /api/products/<site>` - Получить товары по сайту (JSON)
- `GET /api/recent` - Получить недавно найденные товары (JSON)
- `POST /api/refresh` - Запустить парсинг вручную

## Расписание

Парсер автоматически запускается:
- В 09:00 каждый день
- В 21:00 каждый день

## База данных

Данные хранятся в SQLite базе данных `leasing_products.db`. База создается автоматически при первом запуске.

## Деплой на Vercel

Приложение адаптировано для работы на Vercel (serverless):

1. Установите Vercel CLI:
```bash
npm i -g vercel
```

2. Задеплойте проект:
```bash
vercel
```

3. Настройте Cron Jobs в Vercel Dashboard:
   - Перейдите в Settings → Cron Jobs
   - Добавьте задачу: `/api/cron` с расписанием `0 9,21 * * *`

**Важно для Vercel:**
- База данных SQLite хранится в `/tmp` (может очищаться между вызовами)
- Для продакшена рекомендуется использовать внешнюю БД (PostgreSQL, MongoDB)
- Планировщик задач заменен на Vercel Cron Jobs

## Локальная разработка

Для локальной разработки используйте:
```bash
python main.py
```

Для тестирования serverless функции локально:
```bash
vercel dev
```

## Примечания

- Парсер ищет упоминания "leasing"/"liising" и "0%" на страницах товаров
- Результаты сохраняются в базу данных, дубликаты не добавляются
- Веб-интерфейс автоматически обновляет данные каждые 5 минут
- На Vercel база данных может очищаться между вызовами (рекомендуется использовать внешнюю БД)

